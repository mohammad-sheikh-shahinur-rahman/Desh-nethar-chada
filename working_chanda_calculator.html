<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‡¶¶‡ßá‡¶∂‡¶®‡ßá‡¶§‡¶æ‡¶∞ ‡¶ö‡¶æ‡¶Å‡¶¶‡¶æ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡¶ï‡ßÅ‡¶≤‡ßá‡¶ü‡¶∞ - ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶∏‡¶Ç‡¶∏‡ßç‡¶ï‡¶∞‡¶£</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- FontAwesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- html2canvas for screenshot -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <!-- jsPDF for PDF generation -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <!-- QRCode.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

  <style>
    body {
      font-family: 'Noto Sans Bengali', sans-serif;
      background: linear-gradient(-45deg, #d7f3e3, #a7d7f9, #fef3c7, #fce7f3);
      background-size: 400% 400%;
      animation: gradient 15s ease infinite;
      color: #064e3b;
    }

    @keyframes gradient {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    .glass-effect {
      background: rgba(255, 255, 255, 0.25);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.18);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    }

    .result-card {
      background: rgba(240, 253, 244, 0.8);
      backdrop-filter: blur(15px);
      border: 1px solid rgba(34, 197, 94, 0.2);
      box-shadow: 0 10px 40px rgba(34, 197, 94, 0.1);
      transition: all 0.3s ease;
    }

    .result-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 20px 60px rgba(34, 197, 94, 0.2);
    }

    .btn-primary {
      background: linear-gradient(135deg, #10b981, #059669);
      box-shadow: 0 4px 15px rgba(16, 185, 129, 0.4);
      transition: all 0.3s ease;
    }

    .btn-primary:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(16, 185, 129, 0.6);
    }

    .input-field {
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(34, 197, 94, 0.3);
      transition: all 0.3s ease;
    }

    .input-field:focus {
      border-color: #10b981;
      box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
      background: rgba(255, 255, 255, 1);
    }

    .modal-backdrop {
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(5px);
    }

    .modal-content {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .notification {
      position: fixed;
      top: 100px;
      right: 20px;
      z-index: 1000;
      padding: 1rem 1.5rem;
      border-radius: 0.5rem;
      color: white;
      font-weight: 600;
      transform: translateX(400px);
      transition: transform 0.3s ease;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }

    .notification.show {
      transform: translateX(0);
    }

    .notification.success {
      background: linear-gradient(135deg, #10b981, #059669);
    }

    .notification.error {
      background: linear-gradient(135deg, #ef4444, #dc2626);
    }

    .notification.info {
      background: linear-gradient(135deg, #3b82f6, #2563eb);
    }

    .loading-spinner {
      border: 4px solid rgba(16, 185, 129, 0.3);
      border-top: 4px solid #10b981;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .chart-container {
      position: relative;
      height: 300px;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 1rem;
      padding: 1rem;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="fixed w-full top-0 z-50 glass-effect text-emerald-800 shadow-2xl p-4">
    <div class="max-w-6xl mx-auto flex justify-between items-center">
      <div class="flex items-center gap-3">
        <img src="https://upload.wikimedia.org/wikipedia/commons/0/02/Bangladesh_Nationalist_Party_Election_Symbol.svg" alt="BNP" class="w-12 h-12" />
        <h1 class="text-xl font-bold">‡¶¶‡ßá‡¶∂‡¶®‡ßá‡¶§‡¶æ‡¶∞ ‡¶ö‡¶æ‡¶Å‡¶¶‡¶æ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡¶ï‡ßÅ‡¶≤‡ßá‡¶ü‡¶∞</h1>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="max-w-4xl mx-auto mt-24 p-6 glass-effect rounded-2xl">
    <!-- Hero Section -->
    <div class="text-center mb-8">
      <img src="https://upload.wikimedia.org/wikipedia/commons/0/02/Bangladesh_Nationalist_Party_Election_Symbol.svg" class="w-32 h-32 mx-auto mb-4" alt="BNP" />
      <h2 class="text-4xl font-bold text-emerald-800 mb-3">‡¶¶‡ßá‡¶∂‡¶®‡ßá‡¶§‡¶æ‡¶∞ ‡¶ö‡¶æ‡¶Å‡¶¶‡¶æ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡¶ï‡ßÅ‡¶≤‡ßá‡¶ü‡¶∞</h2>
      <p class="text-xl italic text-emerald-700 font-medium">"‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶§‡ßç‡¶Æ‡¶§‡ßç‡¶Ø‡¶æ‡¶ó, ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶¨‡¶æ‡¶ú‡ßá‡¶ü‡•§"</p>
    </div>

    <!-- Calculator Form -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
      <div>
        <label for="profession" class="font-semibold block mb-3 text-lg">
          <i class="fas fa-briefcase mr-2 text-emerald-600"></i>
          ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßá‡¶∂‡¶æ
        </label>
        <select id="profession" class="input-field w-full p-4 rounded-xl text-lg font-medium">
          <option selected disabled>--‡¶™‡ßá‡¶∂‡¶æ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®--</option>
          <option value="doctor">üë®‚Äç‚öïÔ∏è ‡¶°‡¶æ‡¶ï‡ßç‡¶§‡¶æ‡¶∞</option>
          <option value="engineer">üë®‚Äçüíª ‡¶á‡¶û‡ßç‡¶ú‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞</option>
          <option value="teacher">üë®‚Äçüè´ ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶ï</option>
          <option value="businessman">üë®‚Äçüíº ‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡¶æ‡¶Ø‡¶º‡ßÄ</option>
          <option value="govt_job">üèõÔ∏è ‡¶∏‡¶∞‡¶ï‡¶æ‡¶∞‡¶ø ‡¶ö‡¶æ‡¶ï‡ßÅ‡¶∞‡¶ø‡¶ú‡ßÄ‡¶¨‡ßÄ</option>
          <option value="freelancer">üíª ‡¶´‡ßç‡¶∞‡¶ø‡¶≤‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶∏‡¶æ‡¶∞</option>
          <option value="rickshaw_puller">üö≤ ‡¶∞‡¶ø‡¶ï‡¶∂‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶≤‡¶æ</option>
          <option value="day_laborer">üë∑ ‡¶¶‡¶ø‡¶®‡¶Æ‡¶ú‡ßÅ‡¶∞</option>
          <option value="unemployed">üòî ‡¶¨‡ßá‡¶ï‡¶æ‡¶∞</option>
          <option value="expatriate_worker">‚úàÔ∏è ‡¶™‡ßç‡¶∞‡¶¨‡¶æ‡¶∏‡ßÄ ‡¶ï‡¶∞‡ßç‡¶Æ‡ßÄ</option>
        </select>
      </div>
      <div>
        <label for="salary" class="font-semibold block mb-3 text-lg">
          <i class="fas fa-money-bill-wave mr-2 text-emerald-600"></i>
          ‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶Ü‡¶Ø‡¶º (‡ß≥)
        </label>
        <input type="number" id="salary" placeholder="‡ß≥ ‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®..." class="input-field w-full p-4 rounded-xl text-lg font-medium" min="0" />
      </div>
    </div>

    <!-- Error Message -->
    <div id="error-message" class="text-red-600 font-semibold text-center mb-4 hidden">
      <i class="fas fa-exclamation-triangle mr-2"></i>
      <span id="error-text"></span>
    </div>

    <!-- Calculate Button -->
    <div class="text-center mb-8">
      <button id="calculate-btn" class="btn-primary text-white font-bold py-4 px-8 rounded-full text-lg shadow-lg hover:shadow-xl transition-all duration-300">
        <i class="fas fa-calculator mr-2"></i>
        ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®
      </button>
    </div>

    <!-- Loader -->
    <div id="loader" class="text-center mb-8 hidden">
      <div class="loading-spinner mx-auto mb-4"></div>
      <p class="text-emerald-700 font-semibold text-lg">
        <i class="fas fa-cog fa-spin mr-2"></i>
        ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...
      </p>
    </div>

    <!-- Results Section -->
    <section id="result-container" class="hidden">
      <!-- Main Results -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
        <div class="result-card p-6 rounded-2xl">
          <h3 class="font-bold text-xl mb-4 text-emerald-800">
            <i class="fas fa-wallet mr-2"></i>
            ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶π‡¶æ‡¶§‡ßá ‡¶•‡¶æ‡¶ï‡¶¨‡ßá
          </h3>
          <p id="remaining-salary" class="text-4xl font-extrabold text-emerald-600"></p>
        </div>

        <div class="result-card p-6 rounded-2xl flex items-center gap-4">
          <div id="leader-mood-icon" class="text-6xl"></div>
          <div>
            <h3 class="font-bold text-lg text-emerald-800 mb-2">‡¶π‡¶æ‡¶á ‡¶ï‡¶Æ‡¶æ‡¶®‡ßç‡¶°‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ</h3>
            <p id="leader-mood-text" class="font-semibold text-lg"></p>
          </div>
        </div>
      </div>

      <!-- Detailed Stats -->
      <div class="result-card p-6 rounded-2xl mb-8">
        <h3 class="font-bold text-xl mb-4 text-emerald-800">
          <i class="fas fa-chart-bar mr-2"></i>
          ‡¶ö‡¶æ‡¶Å‡¶¶‡¶æ‡¶∞ ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§
        </h3>
        <div id="result-details" class="grid grid-cols-2 lg:grid-cols-4 gap-4"></div>
      </div>

      <!-- Charts Section -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
        <div class="chart-container">
          <h4 class="text-lg font-bold text-emerald-800 mb-4 text-center">
            <i class="fas fa-chart-pie mr-2"></i>
            ‡¶ö‡¶æ‡¶Å‡¶¶‡¶æ‡¶∞ ‡¶¨‡¶ø‡¶§‡¶∞‡¶£
          </h4>
          <canvas id="chadaChart"></canvas>
        </div>
        <div class="chart-container">
          <h4 class="text-lg font-bold text-emerald-800 mb-4 text-center">
            <i class="fas fa-chart-line mr-2"></i>
            ‡¶¨‡¶æ‡¶∞‡ßç‡¶∑‡¶ø‡¶ï ‡¶™‡ßç‡¶∞‡¶ï‡ßç‡¶∑‡ßá‡¶™‡¶£
          </h4>
          <canvas id="yearlyChart"></canvas>
        </div>
      </div>

      <!-- Humor Text -->
      <div class="result-card p-6 rounded-2xl mb-8 text-center">
        <p id="humor-text" class="text-xl italic text-emerald-800 font-semibold"></p>
      </div>

      <!-- Action Buttons -->
      <div class="flex flex-wrap justify-center gap-4 mb-8">
        <button id="generate-invoice-btn" class="btn-primary text-white font-bold py-4 px-8 rounded-full text-lg shadow-lg hover:shadow-xl transition-all duration-300">
          <i class="fas fa-receipt mr-2"></i>
          ‡¶∞‡¶∏‡¶ø‡¶¶ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®
        </button>
        <button id="share-result-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 px-8 rounded-full text-lg shadow-lg hover:shadow-xl transition-all duration-300">
          <i class="fas fa-share-alt mr-2"></i>
          ‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®
        </button>
      </div>

      <!-- Advanced Features -->
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
        <div class="result-card p-6 rounded-2xl text-center">
          <i class="fas fa-chart-line text-4xl text-emerald-600 mb-4"></i>
          <h4 class="font-bold text-lg mb-2">‡¶ü‡ßç‡¶∞‡ßá‡¶®‡ßç‡¶° ‡¶è‡¶®‡¶æ‡¶≤‡¶æ‡¶á‡¶∏‡¶ø‡¶∏</h4>
          <p class="text-sm text-gray-600 mb-4">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ö‡¶æ‡¶Å‡¶¶‡¶æ‡¶∞ ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡ßç‡¶° ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</p>
          <button id="trend-analysis-btn" class="btn-primary px-4 py-2 rounded-lg text-sm">
            ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®
          </button>
        </div>
        
        <div class="result-card p-6 rounded-2xl text-center">
          <i class="fas fa-users text-4xl text-emerald-600 mb-4"></i>
          <h4 class="font-bold text-lg mb-2">‡¶§‡ßÅ‡¶≤‡¶®‡¶æ‡¶Æ‡ßÇ‡¶≤‡¶ï ‡¶¨‡¶ø‡¶∂‡ßç‡¶≤‡ßá‡¶∑‡¶£</h4>
          <p class="text-sm text-gray-600 mb-4">‡¶Ö‡¶®‡ßç‡¶Ø‡¶¶‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶§‡ßÅ‡¶≤‡¶®‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®</p>
          <button id="comparison-btn" class="btn-primary px-4 py-2 rounded-lg text-sm">
            ‡¶§‡ßÅ‡¶≤‡¶®‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®
          </button>
        </div>
        
        <div class="result-card p-6 rounded-2xl text-center">
          <i class="fas fa-trophy text-4xl text-emerald-600 mb-4"></i>
          <h4 class="font-bold text-lg mb-2">‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶°</h4>
          <p class="text-sm text-gray-600 mb-4">‡¶ü‡¶™ ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø‡¶¨‡¶ø‡¶â‡¶ü‡¶∞ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</p>
          <button id="leaderboard-btn" class="btn-primary px-4 py-2 rounded-lg text-sm">
            ‡¶∞‚Äç‡ßç‡¶Ø‡¶æ‡¶ô‡ßç‡¶ï‡¶ø‡¶Ç
          </button>
        </div>
      </div>
    </section>
  </main>

  <!-- Invoice Modal -->
  <div id="invoice-modal" class="fixed inset-0 modal-backdrop flex items-center justify-center p-4 hidden z-50">
    <div class="modal-content rounded-2xl shadow-2xl max-w-2xl w-full p-8 relative max-h-[90vh] overflow-y-auto">
      <button id="close-invoice-btn" class="absolute top-4 right-4 text-gray-600 hover:text-gray-900 text-2xl font-bold">
        <i class="fas fa-times"></i>
      </button>

      <div id="invoice-content" class="select-text">
        <div class="text-center mb-6">
          <img src="https://upload.wikimedia.org/wikipedia/commons/0/02/Bangladesh_Nationalist_Party_Election_Symbol.svg" alt="BNP Logo" class="w-20 h-20 mx-auto mb-4" />
          <h2 class="text-3xl font-bold text-emerald-800 mb-2">‡¶¶‡ßá‡¶∂‡¶®‡ßá‡¶§‡¶æ‡¶∞ ‡¶ö‡¶æ‡¶Å‡¶¶‡¶æ ‡¶∞‡¶∏‡¶ø‡¶¶</h2>
          <p class="text-gray-600">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶ú‡¶æ‡¶§‡ßÄ‡¶Ø‡¶º‡¶§‡¶æ‡¶¨‡¶æ‡¶¶‡ßÄ ‡¶¶‡¶≤ (‡¶¨‡¶ø‡¶è‡¶®‡¶™‡¶ø)</p>
          <div class="w-full h-1 bg-gradient-to-r from-emerald-400 to-emerald-600 my-4"></div>
        </div>
        
        <div id="invoice-body" class="mb-6"></div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
          <div class="text-center">
            <img src="https://upload.wikimedia.org/wikipedia/commons/8/8f/Tarique_Rahman_signature.svg" alt="‡¶¶‡ßá‡¶∂‡¶®‡ßá‡¶§‡¶æ‡¶∞ ‡¶∏‡ßç‡¶¨‡¶æ‡¶ï‡ßç‡¶∑‡¶∞" class="mx-auto w-40 mb-2" />
            <p class="text-sm text-gray-600 font-semibold">‡¶¶‡ßá‡¶∂‡¶®‡ßá‡¶§‡¶æ‡¶∞ ‡¶∏‡ßç‡¶¨‡¶æ‡¶ï‡ßç‡¶∑‡¶∞</p>
            <p class="text-xs text-gray-500">‡¶§‡¶æ‡¶∞‡ßá‡¶ï ‡¶∞‡¶π‡¶Æ‡¶æ‡¶®</p>
          </div>
          <div class="text-center">
            <div id="invoice-qr" class="mx-auto w-32 h-32 mb-2"></div>
            <p class="text-xs text-gray-500">QR ‡¶ï‡ßã‡¶° ‡¶∏‡ßç‡¶ï‡ßç‡¶Ø‡¶æ‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</p>
          </div>
        </div>

        <div class="text-center text-xs text-gray-500 border-t pt-4">
          <p>‡¶è‡¶á ‡¶∞‡¶∏‡¶ø‡¶¶‡¶ü‡¶ø ‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶§‡ßà‡¶∞‡¶ø ‡¶è‡¶¨‡¶Ç ‡¶¨‡ßà‡¶ß</p>
          <p>¬© ‡ß®‡ß¶‡ß®‡ß´ ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶ú‡¶æ‡¶§‡ßÄ‡¶Ø‡¶º‡¶§‡¶æ‡¶¨‡¶æ‡¶¶‡ßÄ ‡¶¶‡¶≤</p>
        </div>
      </div>

      <div class="mt-6 flex flex-wrap justify-center gap-4">
        <button id="download-pdf-btn" class="btn-primary text-white px-6 py-3 rounded-lg font-semibold flex items-center gap-2">
          <i class="fas fa-file-pdf"></i>
          PDF ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°
        </button>
        <button id="download-jpg-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-semibold flex items-center gap-2">
          <i class="fas fa-image"></i>
          JPG ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°
        </button>
        <button id="print-invoice-btn" class="bg-gray-600 hover:bg-gray-700 text-white px-6 py-3 rounded-lg font-semibold flex items-center gap-2">
          <i class="fas fa-print"></i>
          ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
        </button>
      </div>
    </div>
  </div>

  <!-- Feature Modals -->
  <div id="leaderboard-modal" class="fixed inset-0 modal-backdrop flex items-center justify-center p-4 hidden z-50">
    <div class="modal-content rounded-2xl shadow-2xl max-w-lg w-full p-8 relative">
      <button id="close-leaderboard-btn" class="absolute top-4 right-4 text-gray-600 hover:text-gray-900 text-2xl font-bold">
        <i class="fas fa-times"></i>
      </button>
      <h3 class="text-2xl font-bold text-emerald-800 mb-4">
        <i class="fas fa-trophy mr-2"></i>
        ‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶°
      </h3>
      <div id="leaderboard-content"></div>
    </div>
  </div>

  <div id="comparison-modal" class="fixed inset-0 modal-backdrop flex items-center justify-center p-4 hidden z-50">
    <div class="modal-content rounded-2xl shadow-2xl max-w-lg w-full p-8 relative">
      <button id="close-comparison-btn" class="absolute top-4 right-4 text-gray-600 hover:text-gray-900 text-2xl font-bold">
        <i class="fas fa-times"></i>
      </button>
      <h3 class="text-2xl font-bold text-emerald-800 mb-4">
        <i class="fas fa-users mr-2"></i>
        ‡¶§‡ßÅ‡¶≤‡¶®‡¶æ‡¶Æ‡ßÇ‡¶≤‡¶ï ‡¶¨‡¶ø‡¶∂‡ßç‡¶≤‡ßá‡¶∑‡¶£
      </h3>
      <div id="comparison-content"></div>
    </div>
  </div>

  <div id="trend-analysis-modal" class="fixed inset-0 modal-backdrop flex items-center justify-center p-4 hidden z-50">
    <div class="modal-content rounded-2xl shadow-2xl max-w-lg w-full p-8 relative">
      <button id="close-trend-analysis-btn" class="absolute top-4 right-4 text-gray-600 hover:text-gray-900 text-2xl font-bold">
        <i class="fas fa-times"></i>
      </button>
      <h3 class="text-2xl font-bold text-emerald-800 mb-4">
        <i class="fas fa-chart-line mr-2"></i>
        ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡ßç‡¶° ‡¶è‡¶®‡¶æ‡¶≤‡¶æ‡¶á‡¶∏‡¶ø‡¶∏
      </h3>
      <div id="trend-analysis-content"></div>
    </div>
  </div>

  <!-- Notification -->
  <div id="notification" class="notification">
    <span id="notification-text"></span>
  </div>

  <!-- Scripts -->
  <script>
    // Global variables
    let currentCalculation = null;
    let chadaChartInstance = null;
    let yearlyChartInstance = null;

    // Notification system
    function showNotification(message, type = 'success') {
      const notification = document.getElementById('notification');
      const notificationText = document.getElementById('notification-text');
      
      notificationText.textContent = message;
      notification.className = `notification ${type}`;
      notification.classList.add('show');
      
      setTimeout(() => {
        notification.classList.remove('show');
      }, 4000);
    }

    // Format currency in Bangladeshi Taka
    function formatCurrency(amount) {
      return `‡ß≥ ${amount.toLocaleString("bn-BD", {
        minimumFractionDigits: 2,
        maximumFractionDigits: 2,
      })}`;
    }

    // Humor text for profession
    function getHumorText(profession) {
      const texts = {
        doctor: "‡¶°‡¶æ‡¶ï‡ßç‡¶§‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶π‡ßá‡¶¨, ‡¶¶‡ßá‡¶∂‡¶®‡ßá‡¶§‡ßç‡¶∞‡ßÄ‡¶∞ ‡¶ö‡¶ø‡¶ï‡¶ø‡ßé‡¶∏‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶¨‡¶¶‡¶æ‡¶® ‡¶ñ‡ßÅ‡¶¨‡¶á ‡¶ú‡¶∞‡ßÅ‡¶∞‡¶ø!",
        engineer: "‡¶á‡¶û‡ßç‡¶ú‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶π‡ßá‡¶¨, ‡¶®‡¶§‡ßÅ‡¶® ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶ó‡¶°‡¶º‡¶§‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡¶ï‡ßá‡¶ü‡ßá‡¶∞ ‡¶Ö‡¶¨‡¶¶‡¶æ‡¶®‡¶ì ‡¶≤‡¶æ‡¶ó‡¶¨‡ßá!",
        teacher: "‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶ï ‡¶Æ‡¶æ‡¶®‡ßÅ‡¶∑, ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¶‡ßã‡¶Ø‡¶º‡¶æ‡¶ü‡¶æ‡¶á ‡¶¨‡¶°‡¶º ‡¶ï‡¶•‡¶æ‡•§ ‡¶§‡¶¨‡ßá ‡¶¶‡ßã‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá '‡¶¶‡¶æ‡¶®' ‡¶π‡¶≤‡ßá ‡¶ó‡¶£‡¶§‡¶®‡ßç‡¶§‡ßç‡¶∞ ‡¶Æ‡ßÅ‡¶ï‡ßç‡¶§‡¶ø ‡¶™‡¶æ‡¶¨‡ßá‡•§",
        govt_job: "‡¶∏‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶ö‡¶æ‡¶ï‡ßÅ‡¶∞‡ßÄ‡¶ú‡ßÄ‡¶¨‡ßÄ? ‡¶≠‡¶Ø‡¶º ‡¶™‡¶æ‡¶¨‡ßá‡¶® ‡¶®‡¶æ, ‡¶∏‡¶∞‡¶ï‡¶æ‡¶∞ ‡¶¨‡¶¶‡¶≤‡¶æ‡¶≤‡ßá ‡¶Ü‡¶™‡¶®‡¶ø‡¶á ‡¶§‡ßã ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶≤‡ßã‡¶ï!",
        businessman: "‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡¶æ‡¶Ø‡¶º‡ßÄ ‡¶≠‡¶æ‡¶á, ‡¶∂‡¶π‡ßÄ‡¶¶ ‡¶ú‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶Ü‡¶¶‡¶∞‡ßç‡¶∂ ‡¶¨‡¶æ‡¶∏‡ßç‡¶§‡¶¨‡¶æ‡¶Ø‡¶º‡¶®‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡ßã‡¶ó ‡¶Ü‡¶¨‡¶∂‡ßç‡¶Ø‡¶ï!",
        freelancer: "‡¶´‡ßç‡¶∞‡¶ø‡¶≤‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶∏‡¶æ‡¶∞ ‡¶≠‡¶æ‡¶á, ‡¶≤‡¶®‡ßç‡¶°‡¶®‡ßá ‡¶®‡ßá‡¶§‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶õ‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶°‡¶≤‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ñ‡ßÅ‡¶¨ ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞!",
        rickshaw_puller: "‡¶∞‡¶ø‡¶ï‡¶∂‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶≤‡¶æ ‡¶≠‡¶æ‡¶á, ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶≠‡¶æ‡¶°‡¶º‡¶æ‡¶∞ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶®‡ßá‡¶§‡¶æ‡¶∞ ‡¶ó‡¶æ‡¶°‡¶º‡¶ø‡¶∞ ‡¶™‡ßá‡¶ü‡ßç‡¶∞‡ßã‡¶≤! ‡¶ï‡ßÄ ‡¶ö‡¶Æ‡ßé‡¶ï‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶™‡¶æ‡¶∞!",
        day_laborer: "‡¶¶‡¶ø‡¶®‡¶Æ‡¶ú‡ßÅ‡¶∞ ‡¶≠‡¶æ‡¶á, ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶π‡¶æ‡¶°‡¶º‡¶≠‡¶æ‡¶ô‡¶æ ‡¶ñ‡¶æ‡¶ü‡ßÅ‡¶®‡¶ø‡¶∞ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶®‡ßá‡¶§‡¶æ‡¶∞ ‡¶¨‡¶ø‡¶¶‡ßá‡¶∂ ‡¶∏‡¶´‡¶∞! ‡¶¶‡ßá‡¶∂‡¶™‡ßç‡¶∞‡ßá‡¶Æ‡ßá‡¶∞ ‡¶®‡¶Æ‡ßÅ‡¶®‡¶æ!",
        unemployed: "‡¶¨‡ßá‡¶ï‡¶æ‡¶∞ ‡¶≠‡¶æ‡¶á, ‡¶ï‡¶æ‡¶ú ‡¶®‡ßá‡¶á ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶ö‡¶æ‡¶Å‡¶¶‡¶æ ‡¶¶‡¶ø‡¶§‡ßá ‡¶π‡¶¨‡ßá! ‡¶è‡¶ü‡¶æ‡¶á ‡¶§‡ßã ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶™‡¶æ‡¶∞‡ßç‡¶ü‡¶ø‡¶∞ ‡¶®‡¶ø‡¶Ø‡¶º‡¶Æ!",
        expatriate_worker: "‡¶™‡ßç‡¶∞‡¶¨‡¶æ‡¶∏‡ßÄ ‡¶≠‡¶æ‡¶á, ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∞‡ßá‡¶Æ‡¶ø‡¶ü‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶∏‡¶á ‡¶¶‡ßá‡¶∂‡ßá‡¶∞ ‡¶Æ‡ßá‡¶∞‡ßÅ‡¶¶‡¶£‡ßç‡¶°! ‡¶∏‡ßá‡¶á ‡¶Æ‡ßá‡¶∞‡ßÅ‡¶¶‡¶£‡ßç‡¶° ‡¶®‡ßá‡¶§‡¶æ‡¶∞ ‡¶™‡¶ï‡ßá‡¶ü‡ßá!"
      };
      return texts[profession] || "‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ü‡¶æ‡¶ï‡¶æ‡¶Ø‡¶º ‡¶ï‡ßá‡¶®‡¶æ ‡¶™‡ßá‡¶ü‡ßç‡¶∞‡ßã‡¶≤ ‡¶ó‡¶£‡¶§‡¶®‡ßç‡¶§‡ßç‡¶∞‡ßá‡¶∞ ‡¶Æ‡¶∂‡¶æ‡¶≤ ‡¶ú‡ßç‡¶¨‡¶æ‡¶≤‡¶æ‡¶¨‡ßá!";
    }

    // Leader mood based on monthly chada
    function getLeadersMood(monthlyChada) {
      if (monthlyChada < 2000)
        return { icon: "üò°", text: "‡¶ö‡ßá‡¶Ø‡¶º‡¶æ‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶® ‡¶π‡¶§‡¶æ‡¶∂!" };
      if (monthlyChada < 10000)
        return { icon: "ü§î", text: "‡¶≤‡¶®‡ßç‡¶°‡¶® ‡¶•‡ßá‡¶ï‡ßá ‡¶¨‡¶æ‡¶∞‡ßç‡¶§‡¶æ ‡¶Ü‡¶∏‡¶¨‡ßá..." };
      if (monthlyChada < 50000)
        return { icon: "üòÑ", text: "‡¶¶‡ßá‡¶∂‡¶®‡ßá‡¶§‡ßç‡¶∞‡ßÄ ‡¶ñ‡ßÅ‡¶∂‡¶ø ‡¶π‡¶¨‡ßá‡¶®!" };
      if (monthlyChada < 100000)
        return { icon: "üí™", text: "‡¶ú‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶∏‡ßà‡¶®‡¶ø‡¶ï ‡¶∏‡¶´‡¶≤!" };
      return { icon: "üèÜ", text: "‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø ‡¶®‡¶Æ‡¶ø‡¶®‡ßá‡¶∂‡¶®!" };
    }

    // Calculate chada function
    function calculateChada() {
      const profession = document.getElementById("profession").value;
      const salary = parseFloat(document.getElementById("salary").value);

      const resultContainer = document.getElementById("result-container");
      const errorMessage = document.getElementById("error-message");
      const errorText = document.getElementById("error-text");
      const loader = document.getElementById("loader");

      errorMessage.classList.add("hidden");
      resultContainer.classList.add("hidden");

      if (!profession || profession === "default") {
        errorText.textContent = "‡¶¨‡¶ø‡¶™‡ßç‡¶≤‡¶¨‡ßÄ, ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßá‡¶∂‡¶æ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®!";
        errorMessage.classList.remove("hidden");
        showNotification("‡¶™‡ßá‡¶∂‡¶æ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®!", "error");
        return;
      }

      if (isNaN(salary) || salary <= 0) {
        errorText.textContent = "‡¶¨‡¶ø‡¶™‡ßç‡¶≤‡¶¨‡ßÄ, ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶Ø‡¶º‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ ‡¶∏‡¶†‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®!";
        errorMessage.classList.remove("hidden");
        showNotification("‡¶∏‡¶†‡¶ø‡¶ï ‡¶Ü‡¶Ø‡¶º‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®!", "error");
        return;
      }

      // Show loader
      loader.classList.remove("hidden");

      setTimeout(() => {
        loader.classList.add("hidden");

        const monthlyChada = salary * 0.1;
        const remainingSalary = salary * 0.9;
        const dailyChada = monthlyChada / 30;
        const weeklyChada = dailyChada * 7;
        const yearlyChada = monthlyChada * 12;

        // Store current calculation
        currentCalculation = {
          profession,
          salary,
          monthlyChada,
          remainingSalary,
          dailyChada,
          weeklyChada,
          yearlyChada,
          timestamp: new Date().toISOString()
        };

        // Update humor text
        document.getElementById("humor-text").textContent = getHumorText(profession);

        // Leader mood
        const mood = getLeadersMood(monthlyChada);
        document.getElementById("leader-mood-icon").textContent = mood.icon;
        document.getElementById("leader-mood-text").textContent = mood.text;

        // Remaining salary display
        document.getElementById("remaining-salary").textContent = formatCurrency(remainingSalary);

        // Detailed results
        const resultDetails = document.getElementById("result-details");
        resultDetails.innerHTML = "";
        [
          { label: "‡¶¶‡ßà‡¶®‡¶ø‡¶ï", value: formatCurrency(dailyChada), icon: "fas fa-calendar-day" },
          { label: "‡¶∏‡¶æ‡¶™‡ßç‡¶§‡¶æ‡¶π‡¶ø‡¶ï", value: formatCurrency(weeklyChada), icon: "fas fa-calendar-week" },
          { label: "‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï", value: formatCurrency(monthlyChada), icon: "fas fa-calendar-alt" },
          { label: "‡¶¨‡¶æ‡ßé‡¶∏‡¶∞‡¶ø‡¶ï", value: formatCurrency(yearlyChada), icon: "fas fa-calendar" },
        ].forEach((item) => {
          const div = document.createElement("div");
          div.className = "bg-emerald-100 p-4 rounded-xl text-center transition-transform hover:scale-105";
          div.innerHTML = `
            <i class="${item.icon} text-2xl text-emerald-600 mb-2"></i>
            <p class="font-semibold text-emerald-800">${item.label}</p>
            <p class="text-lg font-bold text-emerald-600">${item.value}</p>
          `;
          resultDetails.appendChild(div);
        });

        // Charts
        updateCharts(dailyChada, weeklyChada, monthlyChada, yearlyChada);

        resultContainer.classList.remove("hidden");
        resultContainer.scrollIntoView({ behavior: "smooth" });
        showNotification("‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!", "success");
      }, 1500);
    }

    // Update charts function
    function updateCharts(dailyChada, weeklyChada, monthlyChada, yearlyChada) {
      // Pie Chart
      const ctx1 = document.getElementById("chadaChart").getContext("2d");
      if (chadaChartInstance) chadaChartInstance.destroy();
      
      chadaChartInstance = new Chart(ctx1, {
        type: "doughnut",
        data: {
          labels: ["‡¶¶‡ßà‡¶®‡¶ø‡¶ï", "‡¶∏‡¶æ‡¶™‡ßç‡¶§‡¶æ‡¶π‡¶ø‡¶ï", "‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï", "‡¶¨‡¶æ‡ßé‡¶∏‡¶∞‡¶ø‡¶ï"],
          datasets: [
            {
              label: "‡¶ö‡¶æ‡¶Å‡¶¶‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ (‡¶ü‡¶æ‡¶ï‡¶æ‡¶Ø‡¶º)",
              data: [dailyChada, weeklyChada, monthlyChada, yearlyChada],
              backgroundColor: ["rgba(34,197,94,0.8)", "rgba(59,130,246,0.8)", "rgba(147,51,234,0.8)", "rgba(239,68,68,0.8)"],
              borderColor: "#ffffff",
              borderWidth: 3,
              hoverOffset: 10,
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'bottom',
              labels: {
                padding: 20,
                font: { size: 12, family: 'Noto Sans Bengali' }
              }
            }
          }
        },
      });

      // Line Chart for yearly projection
      const ctx2 = document.getElementById("yearlyChart").getContext("2d");
      if (yearlyChartInstance) yearlyChartInstance.destroy();

      const months = ['‡¶ú‡¶æ‡¶®‡ßÅ‡¶Ø‡¶º‡¶æ‡¶∞‡¶ø', '‡¶´‡ßá‡¶¨‡ßç‡¶∞‡ßÅ‡¶Ø‡¶º‡¶æ‡¶∞‡¶ø', '‡¶Æ‡¶æ‡¶∞‡ßç‡¶ö', '‡¶è‡¶™‡ßç‡¶∞‡¶ø‡¶≤', '‡¶Æ‡ßá', '‡¶ú‡ßÅ‡¶®', '‡¶ú‡ßÅ‡¶≤‡¶æ‡¶á', '‡¶Ü‡¶ó‡¶∏‡ßç‡¶ü', '‡¶∏‡ßá‡¶™‡ßç‡¶ü‡ßá‡¶Æ‡ßç‡¶¨‡¶∞', '‡¶Ö‡¶ï‡ßç‡¶ü‡ßã‡¶¨‡¶∞', '‡¶®‡¶≠‡ßá‡¶Æ‡ßç‡¶¨‡¶∞', '‡¶°‡¶ø‡¶∏‡ßá‡¶Æ‡ßç‡¶¨‡¶∞'];
      const monthlyData = months.map(() => monthlyChada);

      yearlyChartInstance = new Chart(ctx2, {
        type: "line",
        data: {
          labels: months,
          datasets: [
            {
              label: "‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶ö‡¶æ‡¶Å‡¶¶‡¶æ",
              data: monthlyData,
              borderColor: "#10b981",
              backgroundColor: "rgba(16, 185, 129, 0.1)",
              borderWidth: 3,
              fill: true,
              tension: 0.4,
              pointBackgroundColor: "#10b981",
              pointBorderColor: "#ffffff",
              pointBorderWidth: 2,
              pointRadius: 6,
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false }
          },
          scales: {
            y: { beginAtZero: true },
          }
        },
      });
    }

    // Share result function
    function shareResult() {
      if (!currentCalculation) {
        showNotification("‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶ï‡¶∞‡ßÅ‡¶®!", "error");
        return;
      }

      const shareText = `‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶ö‡¶æ‡¶Å‡¶¶‡¶æ: ${formatCurrency(currentCalculation.monthlyChada)}\n‡¶π‡¶æ‡¶§‡ßá ‡¶•‡¶æ‡¶ï‡¶¨‡ßá: ${formatCurrency(currentCalculation.remainingSalary)}\n\n#‡¶¶‡ßá‡¶∂‡¶®‡ßá‡¶§‡¶æ‡¶∞‡¶ö‡¶æ‡¶Å‡¶¶‡¶æ #BNP`;
      
      if (navigator.share) {
        navigator.share({
          title: '‡¶¶‡ßá‡¶∂‡¶®‡ßá‡¶§‡¶æ‡¶∞ ‡¶ö‡¶æ‡¶Å‡¶¶‡¶æ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡¶ï‡ßÅ‡¶≤‡ßá‡¶ü‡¶∞',
          text: shareText,
          url: window.location.href
        });
      } else {
        navigator.clipboard.writeText(shareText).then(() => {
          showNotification("‡¶ï‡ßç‡¶≤‡¶ø‡¶™‡¶¨‡ßã‡¶∞‡ßç‡¶°‡ßá ‡¶ï‡¶™‡¶ø ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!", "success");
        });
      }
    }

    // Invoice generation
    function generateInvoice() {
      if (!currentCalculation) {
        showNotification("‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶ï‡¶∞‡ßÅ‡¶®!", "error");
        return;
      }

      const professionSelect = document.getElementById("profession");
      const selectedProfession = professionSelect.options[professionSelect.selectedIndex].text;
      const today = new Date();
      const dateString = today.toLocaleDateString("bn-BD", {
        day: "2-digit",
        month: "long",
        year: "numeric",
      });

      // Fill invoice modal content
      const invoiceContent = `
        <div class="bg-gradient-to-r from-emerald-50 to-emerald-100 p-6 rounded-lg mb-6">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <h4 class="font-bold text-emerald-800 mb-3">‡¶¨‡ßç‡¶Ø‡¶ï‡ßç‡¶§‡¶ø‡¶ó‡¶§ ‡¶§‡¶•‡ßç‡¶Ø</h4>
              <table class="w-full text-sm">
                <tr class="border-b border-emerald-200">
                  <td class="font-semibold py-2 text-emerald-800">‡¶™‡ßá‡¶∂‡¶æ:</td>
                  <td class="py-2">${selectedProfession}</td>
                </tr>
                <tr class="border-b border-emerald-200">
                  <td class="font-semibold py-2 text-emerald-800">‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶Ü‡¶Ø‡¶º:</td>
                  <td class="py-2 font-bold">${formatCurrency(currentCalculation.salary)}</td>
                </tr>
                <tr>
                  <td class="font-semibold py-2 text-emerald-800">‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ:</td>
                  <td class="py-2">${dateString}</td>
                </tr>
              </table>
            </div>
            <div>
              <h4 class="font-bold text-emerald-800 mb-3">‡¶ö‡¶æ‡¶Å‡¶¶‡¶æ‡¶∞ ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£</h4>
              <table class="w-full text-sm">
                <tr class="border-b border-emerald-200">
                  <td class="font-semibold py-2 text-emerald-800">‡¶¶‡ßà‡¶®‡¶ø‡¶ï:</td>
                  <td class="py-2 font-bold text-emerald-600">${formatCurrency(currentCalculation.dailyChada)}</td>
                </tr>
                <tr class="border-b border-emerald-200">
                  <td class="font-semibold py-2 text-emerald-800">‡¶∏‡¶æ‡¶™‡ßç‡¶§‡¶æ‡¶π‡¶ø‡¶ï:</td>
                  <td class="py-2 font-bold text-emerald-600">${formatCurrency(currentCalculation.weeklyChada)}</td>
                </tr>
                <tr class="border-b border-emerald-200">
                  <td class="font-semibold py-2 text-emerald-800">‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï:</td>
                  <td class="py-2 font-bold text-emerald-600">${formatCurrency(currentCalculation.monthlyChada)}</td>
                </tr>
                <tr>
                  <td class="font-semibold py-2 text-emerald-800">‡¶¨‡¶æ‡ßé‡¶∏‡¶∞‡¶ø‡¶ï:</td>
                  <td class="py-2 font-bold text-emerald-600">${formatCurrency(currentCalculation.yearlyChada)}</td>
                </tr>
              </table>
            </div>
          </div>
        </div>
        <div class="text-center bg-emerald-600 text-white p-4 rounded-lg mb-4">
          <p class="font-bold text-xl">‡¶Æ‡ßã‡¶ü ‡¶¨‡¶æ‡¶ï‡ßÄ ‡¶ü‡¶æ‡¶ï‡¶æ: ${formatCurrency(currentCalculation.remainingSalary)}</p>
          <p class="text-sm opacity-90">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶¨‡¶¶‡¶æ‡¶®‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ß‡¶®‡ßç‡¶Ø‡¶¨‡¶æ‡¶¶!</p>
        </div>
      `;

      document.getElementById("invoice-body").innerHTML = invoiceContent;

      // Generate QR code
      const qrContainer = document.getElementById("invoice-qr");
      qrContainer.innerHTML = "";
      const qrText = `‡¶™‡ßá‡¶∂‡¶æ: ${selectedProfession}\n‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶ö‡¶æ‡¶Å‡¶¶‡¶æ: ${formatCurrency(currentCalculation.monthlyChada)}\n‡¶¨‡¶æ‡¶ï‡ßÄ ‡¶ü‡¶æ‡¶ï‡¶æ: ${formatCurrency(currentCalculation.remainingSalary)}\n‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: ${dateString}`;
      new QRCode(qrContainer, {
        text: qrText,
        width: 128,
        height: 128,
        colorDark: "#065f46",
        colorLight: "#ffffff",
      });

      // Show modal
      document.getElementById("invoice-modal").classList.remove("hidden");
      showNotification("‡¶∞‡¶∏‡¶ø‡¶¶ ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!", "success");
    }

    // Download PDF function
    function downloadPDF() {
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF('p', 'mm', 'a4');
      const invoiceElement = document.getElementById("invoice-content");

      html2canvas(invoiceElement, {
        scale: 2,
        useCORS: true,
        allowTaint: true,
        backgroundColor: '#ffffff'
      }).then((canvas) => {
        const imgData = canvas.toDataURL('image/png');
        const imgProps = pdf.getImageProperties(imgData);
        const pdfWidth = pdf.internal.pageSize.getWidth();
        const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;
        pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
        pdf.save(`‡¶ö‡¶æ‡¶Å‡¶¶‡¶æ-‡¶∞‡¶∏‡¶ø‡¶¶-${Date.now()}.pdf`);
        showNotification("PDF ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!", "success");
      });
    }

    // Download JPG function
    function downloadJPG() {
      const invoiceElement = document.getElementById("invoice-content");
      
      html2canvas(invoiceElement, {
        scale: 2,
        useCORS: true,
        allowTaint: true,
        backgroundColor: '#ffffff'
      }).then((canvas) => {
        const link = document.createElement('a');
        link.download = `‡¶ö‡¶æ‡¶Å‡¶¶‡¶æ-‡¶∞‡¶∏‡¶ø‡¶¶-${Date.now()}.jpg`;
        link.href = canvas.toDataURL('image/jpeg', 0.9);
        link.click();
        showNotification("JPG ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!", "success");
      });
    }

    // Print invoice function
    function printInvoice() {
      const invoiceContent = document.getElementById("invoice-content").innerHTML;
      const printWindow = window.open('', '_blank');
      printWindow.document.write(`
        <html>
          <head>
            <title>‡¶ö‡¶æ‡¶Å‡¶¶‡¶æ ‡¶∞‡¶∏‡¶ø‡¶¶</title>
            <style>
              body { font-family: 'Arial', sans-serif; margin: 20px; }
            </style>
          </head>
          <body>${invoiceContent}</body>
        </html>
      `);
      printWindow.document.close();
      printWindow.print();
      showNotification("‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶°‡¶æ‡¶Ø‡¶º‡¶æ‡¶≤‡¶ó ‡¶ñ‡ßã‡¶≤‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!", "success");
    }

    // Advanced features
    function showTrendAnalysis() {
      if (!currentCalculation) {
        showNotification("‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶ï‡¶∞‡ßÅ‡¶®!", "error");
        return;
      }
      
      const trendModal = document.getElementById('trend-analysis-modal');
      const trendContent = document.getElementById('trend-analysis-content');
      
      // Generate sample trend data
      const months = ['‡¶ú‡¶æ‡¶®‡ßÅ‡¶Ø‡¶º‡¶æ‡¶∞‡¶ø', '‡¶´‡ßá‡¶¨‡ßç‡¶∞‡ßÅ‡¶Ø‡¶º‡¶æ‡¶∞‡¶ø', '‡¶Æ‡¶æ‡¶∞‡ßç‡¶ö', '‡¶è‡¶™‡ßç‡¶∞‡¶ø‡¶≤', '‡¶Æ‡ßá', '‡¶ú‡ßÅ‡¶®'];
      const data = months.map(() => currentCalculation.monthlyChada * (0.8 + Math.random() * 0.4));
      
      trendContent.innerHTML = `
        <div class="mb-4">
          <canvas id="trend-chart" style="height: 300px;"></canvas>
        </div>
        <div class="text-center">
          <p class="text-sm text-gray-600">‡¶ó‡¶§ ‡ß¨ ‡¶Æ‡¶æ‡¶∏‡ßá‡¶∞ ‡¶ö‡¶æ‡¶Å‡¶¶‡¶æ‡¶∞ ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡ßç‡¶°</p>
          <p class="font-bold text-emerald-800">‡¶ó‡¶°‡¶º ‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶ö‡¶æ‡¶Å‡¶¶‡¶æ: ${formatCurrency(data.reduce((a, b) => a + b) / data.length)}</p>
        </div>
      `;
      
      setTimeout(() => {
        new Chart(document.getElementById('trend-chart').getContext('2d'), {
          type: 'line',
          data: {
            labels: months,
            datasets: [{
              label: '‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶ö‡¶æ‡¶Å‡¶¶‡¶æ',
              data: data,
              borderColor: '#10b981',
              backgroundColor: 'rgba(16, 185, 129, 0.1)',
              tension: 0.1,
              fill: true
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } }
          }
        });
      }, 100);
      
      trendModal.classList.remove('hidden');
    }

    function showComparison() {
      if (!currentCalculation) {
        showNotification("‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶ï‡¶∞‡ßÅ‡¶®!", "error");
        return;
      }
      
      const comparisonModal = document.getElementById('comparison-modal');
      const comparisonContent = document.getElementById('comparison-content');
      
      const avgChada = currentCalculation.monthlyChada * 1.2;
      const percentDiff = ((currentCalculation.monthlyChada - avgChada) / avgChada * 100).toFixed(1);
      
      comparisonContent.innerHTML = `
        <div class="space-y-4">
          <div class="bg-emerald-50 p-4 rounded-lg">
            <h4 class="font-bold text-emerald-800 mb-2">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ö‡¶æ‡¶Å‡¶¶‡¶æ</h4>
            <p class="text-2xl font-bold text-emerald-600">${formatCurrency(currentCalculation.monthlyChada)}</p>
          </div>
          <div class="bg-blue-50 p-4 rounded-lg">
            <h4 class="font-bold text-blue-800 mb-2">‡¶ó‡¶°‡¶º ‡¶ö‡¶æ‡¶Å‡¶¶‡¶æ</h4>
            <p class="text-2xl font-bold text-blue-600">${formatCurrency(avgChada)}</p>
          </div>
          <div class="bg-gray-50 p-4 rounded-lg text-center">
            <p class="font-bold text-lg">
              ‡¶Ü‡¶™‡¶®‡¶ø ‡¶ó‡¶°‡¶º ‡¶•‡ßá‡¶ï‡ßá 
              <span class="${currentCalculation.monthlyChada > avgChada ? 'text-green-600' : 'text-red-600'}">
                ${Math.abs(percentDiff)}% ${currentCalculation.monthlyChada > avgChada ? '‡¶¨‡ßá‡¶∂‡¶ø' : '‡¶ï‡¶Æ'}
              </span> 
              ‡¶¶‡¶ø‡¶ö‡ßç‡¶õ‡ßá‡¶®
            </p>
          </div>
        </div>
      `;
      
      comparisonModal.classList.remove('hidden');
    }

    function showLeaderboard() {
      const leaderboardModal = document.getElementById('leaderboard-modal');
      const leaderboardContent = document.getElementById('leaderboard-content');
      
      const leaderboardData = [
        { name: '‡¶¨‡¶ø‡¶™‡ßç‡¶≤‡¶¨‡ßÄ ‡¶Ü‡¶π‡¶Æ‡ßá‡¶¶', chada: 25000, profession: '‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡¶æ‡¶Ø‡¶º‡ßÄ' },
        { name: '‡¶¨‡¶ø‡¶™‡ßç‡¶≤‡¶¨‡ßÄ ‡¶∞‡¶π‡¶ø‡¶Æ', chada: 22000, profession: '‡¶°‡¶æ‡¶ï‡ßç‡¶§‡¶æ‡¶∞' },
        { name: '‡¶¨‡¶ø‡¶™‡ßç‡¶≤‡¶¨‡ßÄ ‡¶ï‡¶∞‡¶ø‡¶Æ', chada: 20000, profession: '‡¶á‡¶û‡ßç‡¶ú‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞' },
        { name: '‡¶¨‡¶ø‡¶™‡ßç‡¶≤‡¶¨‡ßÄ ‡¶∏‡¶æ‡¶≤‡¶æ‡¶Æ', chada: 18000, profession: '‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶ï' },
        { name: '‡¶¨‡¶ø‡¶™‡ßç‡¶≤‡¶¨‡ßÄ ‡¶ú‡¶æ‡¶Æ‡¶æ‡¶≤', chada: 15000, profession: '‡¶ö‡¶æ‡¶ï‡ßÅ‡¶∞‡¶ø‡¶ú‡ßÄ‡¶¨‡ßÄ' },
      ];
      
      leaderboardContent.innerHTML = `
        <div class="space-y-2">
          ${leaderboardData.map((user, i) => `
            <div class="flex justify-between items-center p-3 ${i % 2 === 0 ? 'bg-emerald-50' : 'bg-gray-50'} rounded-lg">
              <div class="flex items-center gap-3">
                <span class="font-bold text-lg ${i < 3 ? 'text-yellow-600' : 'text-gray-600'}">${i+1}</span>
                <div>
                  <p class="font-semibold">${user.name}</p>
                  <p class="text-sm text-gray-600">${user.profession}</p>
                </div>
              </div>
              <div class="text-right">
                <p class="font-bold text-emerald-600">${formatCurrency(user.chada)}</p>
                <p class="text-xs text-gray-500">‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï</p>
              </div>
            </div>
          `).join('')}
        </div>
        <div class="mt-4 text-center text-sm text-gray-600">
          <p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶® ‡¶®‡¶ø‡¶∞‡ßç‡¶≠‡¶∞ ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ö‡¶æ‡¶Å‡¶¶‡¶æ‡¶∞ ‡¶â‡¶™‡¶∞</p>
        </div>
      `;
      
      leaderboardModal.classList.remove('hidden');
    }

    // Event listeners
    document.getElementById("calculate-btn").addEventListener("click", calculateChada);
    document.getElementById("generate-invoice-btn").addEventListener("click", generateInvoice);
    document.getElementById("share-result-btn").addEventListener("click", shareResult);
    document.getElementById("download-pdf-btn").addEventListener("click", downloadPDF);
    document.getElementById("download-jpg-btn").addEventListener("click", downloadJPG);
    document.getElementById("print-invoice-btn").addEventListener("click", printInvoice);
    document.getElementById("close-invoice-btn").addEventListener("click", () => document.getElementById("invoice-modal").classList.add("hidden"));
    document.getElementById("trend-analysis-btn").addEventListener("click", showTrendAnalysis);
    document.getElementById("comparison-btn").addEventListener("click", showComparison);
    document.getElementById("leaderboard-btn").addEventListener("click", showLeaderboard);
    document.getElementById("close-leaderboard-btn").addEventListener("click", () => document.getElementById('leaderboard-modal').classList.add('hidden'));
    document.getElementById("close-comparison-btn").addEventListener("click", () => document.getElementById('comparison-modal').classList.add('hidden'));
    document.getElementById("close-trend-analysis-btn").addEventListener("click", () => document.getElementById('trend-analysis-modal').classList.add('hidden'));

    // Close modals on ESC key
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") {
        document.getElementById("invoice-modal").classList.add("hidden");
        document.getElementById('leaderboard-modal').classList.add('hidden');
        document.getElementById('comparison-modal').classList.add('hidden');
        document.getElementById('trend-analysis-modal').classList.add('hidden');
      }
    });

    // Initialize
    showNotification("‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ! ‡¶ö‡¶æ‡¶Å‡¶¶‡¶æ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡¶ï‡ßÅ‡¶≤‡ßá‡¶ü‡¶∞‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá ‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ‡•§", "success");
  </script>
</body>
</html>

